---
layout: post
title: Using KUNAI (Chapter2 - Disassembler)
date: 2022-08-09 16:50:00
categories: KUNAI
comments: true
en: true
description: Posts about using KUNAI tool for binary analysis
keywords: "Android, Kunai, Programming, Analysis"
authors:
    - Fare9
---

# <a name="Disassembly1"></a> Introduction to Kunai's disassembler

In the previous [post](https://k0deless.github.io/kunai/kunai1/), we saw an introduction to **Kunai**, a static analysis tool aimed to analyze **DEX** files, both from the **DEX** perspective, and also from a *Intermmediate Representation* perspective. We could also see a brief introduction to the architecture of the tool graphically with two schemas.

In this post we will see a brief introduction to the **Disassembler**, in this case we will just focus on the next part of the architecture:

<img src="https://raw.githubusercontent.com/K0deless/k0deless.github.io/master/assets/img/kunai/Disassembler.png" alt="KUNAI Disassembler"/>

As we can see in the picture, the disassembler of **Kunai** is a *Linear Sweep Disassembly* and *Recursive Traversal Disassembly*, an idea for the future is implementing different algorithms of disassembly improving the efficiency of the algorithm.

Two main algorithms exist for disassembly:

* *Linear Sweep Disassembly*: this algorithm takes a bunch of bytes, and starting from the first to the last byte it tries to disassembly all the instructions it finds. In case it gets some error in one of the bytes, the algorithm can go to the next one.

* *Recursive Traversal Disassembly*: in opposite to the previous algorithm, in this one the disassembler tries to start its process in the entry point of the binary, and from that point it starts disassemblying the file and it follows the control flow of the program.

Both algorithms have *pros* and *cons*, for example the former while it will disassembly all the bytes, it can misdisassembly some data bytes as instructions, since the algorithm is not able to differentiate them. Then the latter, while it can avoid data after jump instructions, it can leave some bytes out of the process if there's not a control flow that jumps directly to those bytes (*e.g.* indirect jumps).

In the paper [Practical Analysis of Stripped Binary Code](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.540.6535&rep=rep1&type=pdf), you can find an algorithm that uses the *Recursive Traversal Disassembly* algorithm, together with a collection of heuristics in order to increase precision of the disassembly, this algorithm contains two functions, one very common in *Recursive Traversal Disassembly* that starts disassembly process, and looks for new possible paths to continue disassembly (**FindFunctions**), and once this process has finished, it runs another function that uses a set of precalculated *function prologues* in order to discover newer functions that were not discovered in previous process (**FindPrologues**), more information about the process can be found in Chapter 3 of the book [Surreptitious Software: Obfuscation, Watermarking and Tamperproofing for software protection](https://dl.acm.org/doi/10.5555/1594894), also you can find a whole chapter about this in the book [Practical Binary Analysis](https://practicalbinaryanalysis.com/), and different papers exists about the topic, for example [Disassembly of Executable Code Revisited](https://www2.cs.arizona.edu/~debray/Publications/disasm.pdf). It's planned to include some improvements of the linear sweep and also other algorithms to Kunai's disassembler.

## Using Kunai's disassembler

After all the theory about disassemblers, we'll start working with the disassembler from **Kunai**. As we commented, for the moment only a *Linear Sweep Disassembly* algorithm is implemented, in **Dalvik** the disassembly process commonly is easier, because the bytes that belongs to a method are given by the method itself, we do not have to create any algorithm to recover the methods from the code.

In the previous post, we already said that **Kunai** when it receives a **DEX** file, it does nothing more than parsing its *header*, so whenever we want to use another *analysis* from **Kunai**, we have to get a reference to the object, and then ask the object to apply the analysis. Same will happen with the *disassembler*, if we want **Kunai** to disassembly our target, we will have to obtain a reference to *disassembler* object, and then apply it. *Why don't we directly apply the analysis?* this is an easy to answer question, **Kunai** tries to be as modular as possible. Avoiding doing expensive analysis, give the chance to some analyst to obtain results quickly, if you just one to obtain data from the header, it will take seconds in a long **DEX** to finish, instead of several minutes to apply disassembly, and then *cross-references* and so on.

In the example we'll see in this post, we will create a very basic *disassembler* (similar to **objdump** tool in Linux), and then we will count all the different instructions that appear in the method, and how many times repeat each one.

Let's start with the headers and the beginning of the code:

```cpp
#include <iostream>

#include <KUNAI/DEX/dex.hpp>

int
main(int argc, char **argv)
{
    // check that 4 arguments were given
    if (argc != 4)
    {
        std::cerr << "[-] USAGE: " << argv[0] << " <dex_file> <class_name> <method_name>\n";
        return 1;
    }
```

We will use the common *std::cout* and *std::cerr* to show the information and the errors of the programs, so we will need to use the *iostream* library. Then we will go with **Kunai**, this time, we will use the *dex.hpp* which contains the classes to manage the **DEX** file. Then, we will start the *main* function that will be the only one we will have as it is a simple *"script"*. Inside of the *main* function we will check that 4 arguments are given, being the first one the name of the program (*argv[0]*), and then: **DEX** file, *class name* and finally *method name*. We will use the last two arguments to retrieve the method we want to disassembly.

Let's continue with something we already saw in previous post, the parsing of the **DEX** file using the **DEX** object from **Kunai**.

```cpp
    // watch info and error messages from Kunai
    spdlog::set_level(spdlog::level::err);

    auto class_name = std::string(argv[2]);
    auto method_name = std::string(argv[3]);

    std::ifstream dex_file;

    dex_file.open(argv[1], std::ios::binary);

    auto fsize = dex_file.tellg();
    dex_file.seekg(0, std::ios::end);
    fsize = dex_file.tellg() - fsize;
    dex_file.seekg(0);

    auto dex_object = KUNAI::DEX::get_unique_dex_object(dex_file, fsize);

    if (!dex_object->get_parsing_correct())
    {
        std::cerr << "Error analyzing " << argv[1] << ", maybe DEX file is not correct...\n";
        return 2;
    }
```

Again we set the log level from **Kunai** using **spdlog** (library used by **Kunai** for logging). After that, we save in *string* objects the arguments with the class name, and the argument with the method name. Then we can start opening the **DEX** file given, and after calculating its size, we create a unique **DEX** object, this is a *std::unique_ptr* which holds the **DEX** information in **Kunai**. Finally we'll check if the parsing process was correct.

```cpp
    // first of all obtain the disassembler object
    auto dex_disassembler = dex_object->get_dex_disassembler();

    // because obtaining the dex object does not apply
    // any analysis, we have to apply disassembly by
    // ourselves
    dex_disassembler->disassembly_analysis();

    // check that all the disassembly was correct
    if (!dex_disassembler->get_disassembly_correct())
    {
        std::cerr << "Error in the disassembly of " << argv[1] << ", maybe some method was incorrect...\n";
        return 3;
    }
```

From the **DEX** object we obtain the **DexDisassembler** object, this object contains the *linear sweep disassembler* and once we finish the *disassembly* process, it will contain the instructions for each method. From the **DexDisassembler** object we run its method *disassembly_analysis*, this will traverse all the methods from the **DEX** file, and will fill the previous commented variable with all the instructions. Then we can check if the process was correct or not for showing information to the user.

```cpp
    // instruction_map_t = std::map<std::tuple<classdef_t, encodedmethod_t>, std::map<std::uint64_t, instruction_t>>;
    // instruction_map_t is a map that contains as key a tuple with the class and method
    // and as value a map that contains ordered the address of the instruction
    // and the instruction.
    auto instruction_map = dex_disassembler->get_instructions();
```

Then we obtain a reference to the instructions structure, this variable is a *std::map* with a little bit complex structure, the key for the map is a *std::tuple* that contains a *classdef_t* object and *encodedmethod_t* object. Finally the value is a *std::map* that contains a *std::uint64_t* with the *address* or *idx* of the instruction in the method, and finally the *instruction_t* object. 

Let's go over this structure looking for the class and the method we want:

```cpp
    // let's create the variable that will hold all those instructions
    // that appear and how many times appear.
    std::unordered_map<std::uint32_t, size_t> instruction_counter;

    for (const auto& disassembly : instruction_map)
    {

        auto& classdef = std::get<0>(disassembly.first);
        auto& encoded_method = std::get<1>(disassembly.first);

        if (classdef == nullptr || encoded_method == nullptr)
            continue;
        
        if (!class_name.compare(classdef->get_class_idx()->get_name()) &&
            !method_name.compare(*encoded_method->get_method()->get_method_name()))
        {
            std::cout << "Disassembly of " << class_name << "->" << method_name << "\n";

            for (const auto& instructions : disassembly.second)
            {
                std::cout << std::right << std::setfill('0') << std::setw(8) << std::hex << instructions.first << "  ";
                instructions.second->show_instruction();
                std::cout << std::endl;


                auto& instr = instructions.second;
                auto op = instr->get_OP();

                if (instruction_counter.find(op) == instruction_counter.end())
                    instruction_counter[op] = 0;
                
                instruction_counter[op] += 1;
            }

            break;
        }
    }
```

First of all we will create the *std::unordered_map* that will hold the instructions and the count of those instructions, then we will go through the instructions structure, we want to obtain data only from a specific method, then we will compare names in order to obtain that data. To do that we will have to retrieve name from the *classdef_t* object, first obtaining the *class_t* object, and from it the name of the class. And from the *encodedmethod_t* we obtain the *methodid_t* and from it the method name. Once we have found the method we are interested, we can go over the instructions.

As we said at the beginning, what we'll do is to write a *disassembler*, then we will print the name of the method to disassembly, and after that we will go over each of the instructions, first we show the *address* and after that we invoke the method *show_instruction* that will format the disassembly of that specific instruction, so we do not have to care about what kind of *Instruction* object is (check the picture at the beginning of the post to see all the instruction types). Then, we will retrieve its *op-code*, and we'll start counting instructions.

```cpp
    std::cout << "\n\nInstruction counter program\n";
    std::cout << "Number of different instructions present in the method: " << instruction_counter.size() << "\n";
    for (const auto & op_instr : instruction_counter)
    {
        auto op_num = op_instr.first;
        auto op_str = dex_object->get_dalvik_opcode_object()->get_instruction_name(op_num);
        
        std::cout << op_str << " [" << op_num << "] appears: " << op_instr.second << " times\n";
    }

    return 0;
}
```

Finally we will go over the variable we created to count the instructions, and we'll show what instruction appears in the method, and how many times appear. Let's compile the program, and run it with a example **DEX**:

```console
$ g++ -std=c++17 instruction-counter.cpp -o instruction-counter -lkunai
$ ./instruction-counter ../tests/test-modexp/Main.dex "LMain;" "modexp"
Disassembly of LMain;->modexp
00000000  nop                      
00000002  nop                      
00000004  const/4                  v0, 0
00000006  const/4                  v1, 1
00000008  const/4                  v2, 0
0000000a  const/4                  v3, 1
0000000c  if-ge                    v0, p2, 19
00000010  aget                     v2, p1, v0
00000014  if-ne                    v2, v1, 7
00000018  mul-int                  v3, v3, p0
0000001c  rem-int/2addr            v3, p3
0000001e  move                     v2, v3
00000020  goto                     2
00000022  move                     v2, v3
00000024  mul-int                  v3, v2, v2
00000028  rem-int/2addr            v3, p3
0000002a  nop                      
0000002c  add-int/lit8             v0, v0, 1
00000030  goto                     -18
00000032  return                   v2


Instruction counter program
Number of different instructions present in the method: b
return [f] appears: 1 times
add-int/lit8 [d8] appears: 1 times
rem-int/2addr [b4] appears: 2 times
if-ne [33] appears: 1 times
mul-int [92] appears: 2 times
aget [44] appears: 1 times
goto [28] appears: 2 times
move [1] appears: 2 times
if-ge [35] appears: 1 times
const/4 [12] appears: 4 times
nop [0] appears: 3 times
```

Here we can see the output of the disassembler, and finally the instruction counting. As we can see only 11 (0xb) different instructions exists, and as the method is not so big, they do not appear so many times.

Let's go now with a method used as interpreter in a VM-based obfuscation:

```cpp
$ ./instruction-counter ../tests/test-vm/PCodeVM.dex "LPCodeVM;" "exec"
Disassembly of LPCodeVM;->exec
00000000  nop                      
00000002  const/16                 v0, 255
00000006  const/16                 v1, 128
0000000a  const/4                  v2, 5
0000000c  const/4                  v3, 7
0000000e  const/4                  v4, 6
00000010  const/4                  v5, 3
00000012  const/16                 v6, 9
00000016  const/16                 v7, 8
0000001a  const/16                 v8, 10
0000001e  const/16                 v9, 11
00000022  const/4                  v10, 2
00000024  const/4                  v11, 0
00000026  const/4                  v12, 0
00000028  const/4                  v13, 1
0000002a  packed-switch            p1, 1187
00000030  return                   p1
00000032  nop                      
00000034  iget                     p1, p0, I LPCodeVM;.stkidx
00000038  add-int/lit8             p1, p1, -2
0000003c  iput                     p1, p0, I LPCodeVM;.stkidx
00000040  iget-object              v0, p0, [I LPCodeVM;.istk
00000044  aget                     v1, v0, p1
00000048  add-int/2addr            p1, v13
0000004a  aget                     p1, v0, p1
0000004e  if-lt                    v1, p1, 3
00000052  const/4                  v13, 0
00000054  iput                     v13, p0, I LPCodeVM;.b
00000058  return                   v12
0000005a  iget                     p1, p0, I LPCodeVM;.stkidx
0000005e  add-int/lit8             v0, p1, 1
00000062  iput                     v0, p0, I LPCodeVM;.stkidx
00000066  iget-object              v1, p0, [I LPCodeVM;.istk
0000006a  aget                     v2, v1, v9
0000006e  aput                     v2, v1, p1
00000072  nop                      
00000074  add-int/lit8             p1, v0, 1
00000078  iput                     p1, p0, I LPCodeVM;.stkidx
0000007c  iget-object              v2, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000080  aget-object              v3, v2, v4
00000084  aput-object              v3, v2, v0
00000088  add-int/lit8             v0, p1, -1
0000008c  add-int/lit8             v3, p1, -1
00000090  aget-object              v3, v2, v3
00000094  sub-int/2addr            p1, v13
00000096  aput-object              v11, v2, p1
0000009a  check-cast               v3, [B
0000009e  array-length             p1, v3
000000a0  aput                     p1, v1, v0
000000a4  return                   v12
000000a6  iget                     p1, p0, I LPCodeVM;.stkidx
000000aa  sub-int/2addr            p1, v13
000000ac  iput                     p1, p0, I LPCodeVM;.stkidx
000000b0  iget-object              v0, p0, [I LPCodeVM;.istk
000000b4  aget                     v1, v0, p1
000000b8  aput                     v1, v0, v8
000000bc  nop                      
000000be  add-int/lit8             v1, p1, 1
000000c2  iput                     v1, p0, I LPCodeVM;.stkidx
000000c6  aget                     v2, v0, v9
000000ca  aput                     v2, v0, p1
000000ce  nop                      
000000d0  add-int/lit8             p1, v1, 1
000000d4  iput                     p1, p0, I LPCodeVM;.stkidx
000000d8  aput                     v5, v0, v1
000000dc  return                   v12
000000de  iget                     p1, p0, I LPCodeVM;.stkidx
000000e2  sub-int/2addr            p1, v13
000000e4  iput                     p1, p0, I LPCodeVM;.stkidx
000000e8  add-int/lit8             v0, p1, -1
000000ec  iget-object              v1, p0, [Ljava/lang/Object; LPCodeVM;.lstk
000000f0  add-int/lit8             v2, p1, -1
000000f4  aget-object              v2, v1, v2
000000f8  add-int/lit8             v3, p1, -1
000000fc  aput-object              v11, v1, v3
00000100  iget-object              v1, p0, [I LPCodeVM;.istk
00000104  check-cast               v2, [B
00000108  aget                     p1, v1, p1
0000010c  aget-byte                p1, v2, p1
00000110  aput                     p1, v1, v0
00000114  return                   v12
00000116  iget                     p1, p0, I LPCodeVM;.stkidx
0000011a  sub-int/2addr            p1, v13
0000011c  iput                     p1, p0, I LPCodeVM;.stkidx
00000120  iget-object              v0, p0, [I LPCodeVM;.istk
00000124  add-int/lit8             v1, p1, -1
00000128  aget                     v2, v0, v1
0000012c  aget                     v3, v0, p1
00000130  and-int/2addr            v2, v3
00000132  aput                     v2, v0, v1
00000136  sub-int/2addr            p1, v13
00000138  iput                     p1, p0, I LPCodeVM;.stkidx
0000013c  aget                     p1, v0, p1
00000140  aput                     p1, v0, v8
00000144  return                   v12
00000146  iget                     p1, p0, I LPCodeVM;.stkidx
0000014a  add-int/lit8             v0, p1, 1
0000014e  iput                     v0, p0, I LPCodeVM;.stkidx
00000152  iget-object              v1, p0, [I LPCodeVM;.istk
00000156  aget                     v2, v1, v6
0000015a  aput                     v2, v1, p1
0000015e  sub-int/2addr            v0, v13
00000160  iput                     v0, p0, I LPCodeVM;.stkidx
00000164  add-int/lit8             p1, v0, -1
00000168  iget-object              v2, p0, [Ljava/lang/Object; LPCodeVM;.lstk
0000016c  add-int/lit8             v3, v0, -1
00000170  aget-object              v3, v2, v3
00000174  add-int/lit8             v4, v0, -1
00000178  aput-object              v11, v2, v4
0000017c  check-cast               v3, [B
00000180  aget                     v2, v1, v0
00000184  aget-byte                v2, v3, v2
00000188  aput                     v2, v1, p1
0000018c  sub-int/2addr            v0, v13
0000018e  iput                     v0, p0, I LPCodeVM;.stkidx
00000192  add-int/lit8             p1, v0, -1
00000196  aget                     v2, v1, p1
0000019a  aget                     v0, v1, v0
0000019e  add-int/2addr            v2, v0
000001a0  aput                     v2, v1, p1
000001a4  return                   v12
000001a6  iget                     p1, p0, I LPCodeVM;.stkidx
000001aa  sub-int/2addr            p1, v13
000001ac  iput                     p1, p0, I LPCodeVM;.stkidx
000001b0  add-int/lit8             v0, p1, -1
000001b4  iget-object              v1, p0, [Ljava/lang/Object; LPCodeVM;.lstk
000001b8  add-int/lit8             v3, p1, -1
000001bc  aget-object              v3, v1, v3
000001c0  add-int/lit8             v4, p1, -1
000001c4  aput-object              v11, v1, v4
000001c8  iget-object              v4, p0, [I LPCodeVM;.istk
000001cc  check-cast               v3, [B
000001d0  aget                     v5, v4, p1
000001d4  aget-byte                v3, v3, v5
000001d8  aput                     v3, v4, v0
000001dc  nop                      
000001de  add-int/lit8             v0, p1, 1
000001e2  iput                     v0, p0, I LPCodeVM;.stkidx
000001e6  aget-object              v0, v1, v2
000001ea  aput-object              v0, v1, p1
000001ee  return                   v12
000001f0  iget                     p1, p0, I LPCodeVM;.stkidx
000001f4  add-int/lit8             v0, p1, 1
000001f8  iput                     v0, p0, I LPCodeVM;.stkidx
000001fc  iget-object              v1, p0, [I LPCodeVM;.istk
00000200  aget                     v2, v1, v8
00000204  aput                     v2, v1, p1
00000208  add-int/lit8             v0, v0, -3
0000020c  iput                     v0, p0, I LPCodeVM;.stkidx
00000210  iget-object              p1, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000214  aget-object              v2, p1, v0
00000218  aput-object              v11, p1, v0
0000021c  check-cast               v2, [B
00000220  add-int/lit8             p1, v0, 1
00000224  aget                     p1, v1, p1
00000228  add-int/2addr            v0, v10
0000022a  aget                     v0, v1, v0
0000022e  int-to-byte              v0, v0
00000230  aput-byte                v0, v2, p1
00000234  return                   v12
00000236  iget                     p1, p0, I LPCodeVM;.stkidx
0000023a  sub-int/2addr            p1, v13
0000023c  iput                     p1, p0, I LPCodeVM;.stkidx
00000240  add-int/lit8             v0, p1, -1
00000244  iget-object              v1, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000248  add-int/lit8             v2, p1, -1
0000024c  aget-object              v2, v1, v2
00000250  add-int/lit8             v3, p1, -1
00000254  aput-object              v11, v1, v3
00000258  iget-object              v3, p0, [I LPCodeVM;.istk
0000025c  check-cast               v2, [B
00000260  aget                     v4, v3, p1
00000264  aget-byte                v2, v2, v4
00000268  aput                     v2, v3, v0
0000026c  add-int/lit8             p1, p1, -3
00000270  iput                     p1, p0, I LPCodeVM;.stkidx
00000274  aget-object              v0, v1, p1
00000278  aput-object              v11, v1, p1
0000027c  check-cast               v0, [B
00000280  add-int/lit8             v1, p1, 1
00000284  aget                     v1, v3, v1
00000288  add-int/2addr            p1, v10
0000028a  aget                     p1, v3, p1
0000028e  int-to-byte              p1, p1
00000290  aput-byte                p1, v0, v1
00000294  return                   v12
00000296  iget                     p1, p0, I LPCodeVM;.stkidx
0000029a  add-int/lit8             v0, p1, 1
0000029e  iput                     v0, p0, I LPCodeVM;.stkidx
000002a2  iget-object              v0, p0, [I LPCodeVM;.istk
000002a6  aget                     v1, v0, v7
000002aa  aput                     v1, v0, p1
000002ae  return                   v12
000002b0  iget                     p1, p0, I LPCodeVM;.stkidx
000002b4  add-int/lit8             v0, p1, 1
000002b8  iput                     v0, p0, I LPCodeVM;.stkidx
000002bc  iget-object              v1, p0, [Ljava/lang/Object; LPCodeVM;.lstk
000002c0  add-int/lit8             v2, v0, -2
000002c4  aget-object              v2, v1, v2
000002c8  add-int/lit8             v3, v0, -2
000002cc  aput-object              v11, v1, v3
000002d0  aput-object              v2, v1, p1
000002d4  iget-object              p1, p0, [I LPCodeVM;.istk
000002d8  add-int/lit8             v3, v0, -2
000002dc  add-int/lit8             v4, v0, -3
000002e0  aget                     v4, p1, v4
000002e4  aput                     v4, p1, v3
000002e8  sub-int/2addr            v0, v5
000002ea  aput-object              v2, v1, v0
000002ee  return                   v12
000002f0  iget                     p1, p0, I LPCodeVM;.stkidx
000002f4  add-int/lit8             v0, p1, 1
000002f8  iput                     v0, p0, I LPCodeVM;.stkidx
000002fc  iget-object              v1, p0, [I LPCodeVM;.istk
00000300  aget                     v2, v1, v6
00000304  aput                     v2, v1, p1
00000308  sub-int/2addr            v0, v13
0000030a  iput                     v0, p0, I LPCodeVM;.stkidx
0000030e  add-int/lit8             p1, v0, -1
00000312  iget-object              v2, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000316  add-int/lit8             v3, v0, -1
0000031a  aget-object              v3, v2, v3
0000031e  add-int/lit8             v4, v0, -1
00000322  aput-object              v11, v2, v4
00000326  check-cast               v3, [B
0000032a  aget                     v2, v1, v0
0000032e  aget-byte                v2, v3, v2
00000332  aput                     v2, v1, p1
00000336  sub-int/2addr            v0, v13
00000338  iput                     v0, p0, I LPCodeVM;.stkidx
0000033c  aget                     p1, v1, v0
00000340  aput                     p1, v1, v8
00000344  return                   v12
00000346  iget                     p1, p0, I LPCodeVM;.stkidx
0000034a  sub-int/2addr            p1, v13
0000034c  iput                     p1, p0, I LPCodeVM;.stkidx
00000350  iget-object              v0, p0, [I LPCodeVM;.istk
00000354  aget                     v1, v0, p1
00000358  aput                     v1, v0, v6
0000035c  nop                      
0000035e  add-int/lit8             v0, p1, 1
00000362  iput                     v0, p0, I LPCodeVM;.stkidx
00000366  iget-object              v0, p0, [Ljava/lang/Object; LPCodeVM;.lstk
0000036a  aget-object              v1, v0, v2
0000036e  aput-object              v1, v0, p1
00000372  return                   v12
00000374  iget                     p1, p0, I LPCodeVM;.stkidx
00000378  sub-int/2addr            p1, v13
0000037a  iput                     p1, p0, I LPCodeVM;.stkidx
0000037e  iget-object              v0, p0, [I LPCodeVM;.istk
00000382  add-int/lit8             v1, p1, -1
00000386  aget                     v2, v0, v1
0000038a  aget                     p1, v0, p1
0000038e  and-int/2addr            p1, v2
00000390  aput                     p1, v0, v1
00000394  return                   v12
00000396  iget                     p1, p0, I LPCodeVM;.stkidx
0000039a  add-int/lit8             v1, p1, 1
0000039e  iput                     v1, p0, I LPCodeVM;.stkidx
000003a2  iget-object              v1, p0, [I LPCodeVM;.istk
000003a6  aput                     v0, v1, p1
000003aa  return                   v12
000003ac  iget                     p1, p0, I LPCodeVM;.stkidx
000003b0  sub-int/2addr            p1, v13
000003b2  iput                     p1, p0, I LPCodeVM;.stkidx
000003b6  iget-object              v0, p0, [I LPCodeVM;.istk
000003ba  add-int/lit8             v1, p1, -1
000003be  aget                     v2, v0, v1
000003c2  aget                     p1, v0, p1
000003c6  add-int/2addr            v2, p1
000003c8  aput                     v2, v0, v1
000003cc  return                   v12
000003ce  iget                     p1, p0, I LPCodeVM;.stkidx
000003d2  add-int/lit8             v0, p1, 1
000003d6  iput                     v0, p0, I LPCodeVM;.stkidx
000003da  iget-object              v1, p0, [I LPCodeVM;.istk
000003de  aget                     v2, v1, v7
000003e2  aput                     v2, v1, p1
000003e6  sub-int/2addr            v0, v13
000003e8  iput                     v0, p0, I LPCodeVM;.stkidx
000003ec  add-int/lit8             p1, v0, -1
000003f0  iget-object              v2, p0, [Ljava/lang/Object; LPCodeVM;.lstk
000003f4  add-int/lit8             v3, v0, -1
000003f8  aget-object              v3, v2, v3
000003fc  add-int/lit8             v4, v0, -1
00000400  aput-object              v11, v2, v4
00000404  check-cast               v3, [B
00000408  aget                     v0, v1, v0
0000040c  aget-byte                v0, v3, v0
00000410  aput                     v0, v1, p1
00000414  return                   v12
00000416  iget                     p1, p0, I LPCodeVM;.stkidx
0000041a  add-int/lit8             v0, p1, 1
0000041e  iput                     v0, p0, I LPCodeVM;.stkidx
00000422  iget-object              v0, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000426  iget-object              v1, p0, Ljava/lang/Object; LPCodeVM;.g
0000042a  aput-object              v1, v0, p1
0000042e  return                   v12
00000430  iget                     p1, p0, I LPCodeVM;.peekidx
00000434  add-int/lit8             v0, p1, 1
00000438  iput                     v0, p0, I LPCodeVM;.peekidx
0000043c  iget-object              v0, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000440  aget-object              v1, v0, p1
00000444  aput-object              v11, v0, p1
00000448  iput-object              v1, p0, Ljava/lang/Object; LPCodeVM;.i
0000044c  return                   v12
0000044e  iget                     p1, p0, I LPCodeVM;.stkidx
00000452  add-int/lit8             v0, p1, 1
00000456  iput                     v0, p0, I LPCodeVM;.stkidx
0000045a  iget-object              v0, p0, [Ljava/lang/Object; LPCodeVM;.lstk
0000045e  aget-object              v1, v0, v2
00000462  aput-object              v1, v0, p1
00000466  return                   v12
00000468  iget                     p1, p0, I LPCodeVM;.stkidx
0000046c  add-int/lit8             v0, p1, 1
00000470  iput                     v0, p0, I LPCodeVM;.stkidx
00000474  iget-object              v0, p0, [I LPCodeVM;.istk
00000478  aget                     v1, v0, v6
0000047c  aput                     v1, v0, p1
00000480  return                   v12
00000482  iget                     p1, p0, I LPCodeVM;.stkidx
00000486  sub-int/2addr            p1, v13
00000488  iput                     p1, p0, I LPCodeVM;.stkidx
0000048c  iget-object              v0, p0, [I LPCodeVM;.istk
00000490  aget                     p1, v0, p1
00000494  aput                     p1, v0, v7
00000498  return                   v12
0000049a  iget                     p1, p0, I LPCodeVM;.stkidx
0000049e  add-int/lit8             v1, p1, 1
000004a2  iput                     v1, p0, I LPCodeVM;.stkidx
000004a6  iget-object              v2, p0, [I LPCodeVM;.istk
000004aa  aput                     v0, v2, p1
000004ae  sub-int/2addr            v1, v13
000004b0  iput                     v1, p0, I LPCodeVM;.stkidx
000004b4  add-int/lit8             p1, v1, -1
000004b8  aget                     v0, v2, p1
000004bc  aget                     v1, v2, v1
000004c0  and-int/2addr            v0, v1
000004c2  aput                     v0, v2, p1
000004c6  return                   v12
000004c8  iget                     p1, p0, I LPCodeVM;.stkidx
000004cc  add-int/lit8             v0, p1, 1
000004d0  iput                     v0, p0, I LPCodeVM;.stkidx
000004d4  iget-object              v1, p0, [I LPCodeVM;.istk
000004d8  aget                     v2, v1, v7
000004dc  aput                     v2, v1, p1
000004e0  nop                      
000004e2  add-int/lit8             p1, v0, 1
000004e6  iput                     p1, p0, I LPCodeVM;.stkidx
000004ea  aput                     v13, v1, v0
000004ee  sub-int/2addr            p1, v13
000004f0  iput                     p1, p0, I LPCodeVM;.stkidx
000004f4  add-int/lit8             v0, p1, -1
000004f8  aget                     v2, v1, v0
000004fc  aget                     p1, v1, p1
00000500  add-int/2addr            v2, p1
00000502  aput                     v2, v1, v0
00000506  return                   v12
00000508  iget                     p1, p0, I LPCodeVM;.stkidx
0000050c  sub-int/2addr            p1, v13
0000050e  iput                     p1, p0, I LPCodeVM;.stkidx
00000512  iget-object              v0, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000516  aput-object              v11, v0, p1
0000051a  return                   v12
0000051c  iget                     p1, p0, I LPCodeVM;.stkidx
00000520  sub-int/2addr            p1, v13
00000522  iput                     p1, p0, I LPCodeVM;.stkidx
00000526  iget-object              v0, p0, [I LPCodeVM;.istk
0000052a  aget                     p1, v0, p1
0000052e  iput                     p1, p0, I LPCodeVM;.b
00000532  return                   v12
00000534  iget                     p1, p0, I LPCodeVM;.stkidx
00000538  sub-int/2addr            p1, v13
0000053a  iput                     p1, p0, I LPCodeVM;.stkidx
0000053e  iget-object              v0, p0, [I LPCodeVM;.istk
00000542  aget                     p1, v0, p1
00000546  if-nez                   p1, 3
0000054a  const/4                  v13, 0
0000054c  iput                     v13, p0, I LPCodeVM;.b
00000550  return                   v12
00000552  iget                     p1, p0, I LPCodeVM;.stkidx
00000556  sub-int/2addr            p1, v13
00000558  iput                     p1, p0, I LPCodeVM;.stkidx
0000055c  iget-object              v0, p0, [I LPCodeVM;.istk
00000560  add-int/lit8             v2, p1, -1
00000564  aget                     v3, v0, v2
00000568  aget                     v4, v0, p1
0000056c  add-int/2addr            v3, v4
0000056e  aput                     v3, v0, v2
00000572  nop                      
00000574  add-int/lit8             v2, p1, 1
00000578  iput                     v2, p0, I LPCodeVM;.stkidx
0000057c  add-int/lit8             v3, v2, -2
00000580  aget                     v3, v0, v3
00000584  aput                     v3, v0, p1
00000588  nop                      
0000058a  add-int/lit8             p1, v2, 1
0000058e  iput                     p1, p0, I LPCodeVM;.stkidx
00000592  aput                     v1, v0, v2
00000596  return                   v12
00000598  iget                     p1, p0, I LPCodeVM;.stkidx
0000059c  add-int/lit8             v0, p1, 1
000005a0  iput                     v0, p0, I LPCodeVM;.stkidx
000005a4  iget-object              v0, p0, [I LPCodeVM;.istk
000005a8  const/16                 v1, 31
000005ac  aput                     v1, v0, p1
000005b0  return                   v12
000005b2  iget                     p1, p0, I LPCodeVM;.stkidx
000005b6  add-int/lit8             v0, p1, 1
000005ba  iput                     v0, p0, I LPCodeVM;.stkidx
000005be  iget-object              v0, p0, [I LPCodeVM;.istk
000005c2  aput                     v13, v0, p1
000005c6  return                   v12
000005c8  iget                     p1, p0, I LPCodeVM;.stkidx
000005cc  add-int/lit8             p1, p1, -3
000005d0  iput                     p1, p0, I LPCodeVM;.stkidx
000005d4  iget-object              v0, p0, [Ljava/lang/Object; LPCodeVM;.lstk
000005d8  aget-object              v1, v0, p1
000005dc  aput-object              v11, v0, p1
000005e0  check-cast               v1, [B
000005e4  iget-object              v0, p0, [I LPCodeVM;.istk
000005e8  add-int/lit8             v2, p1, 1
000005ec  aget                     v2, v0, v2
000005f0  add-int/2addr            p1, v10
000005f2  aget                     p1, v0, p1
000005f6  int-to-byte              p1, p1
000005f8  aput-byte                p1, v1, v2
000005fc  aget                     p1, v0, v9
00000600  add-int/2addr            p1, v13
00000602  aput                     p1, v0, v9
00000606  return                   v12
00000608  iget-object              p1, p0, [I LPCodeVM;.istk
0000060c  iget                     v0, p0, I LPCodeVM;.stkidx
00000610  add-int/lit8             v1, v0, -1
00000614  sub-int/2addr            v0, v13
00000616  aget                     v0, p1, v0
0000061a  int-to-byte              v0, v0
0000061c  aput                     v0, p1, v1
00000620  return                   v12
00000622  iget                     p1, p0, I LPCodeVM;.stkidx
00000626  add-int/lit8             v0, p1, 1
0000062a  iput                     v0, p0, I LPCodeVM;.stkidx
0000062e  iget-object              v1, p0, [I LPCodeVM;.istk
00000632  aput                     v5, v1, p1
00000636  sub-int/2addr            v0, v13
00000638  iput                     v0, p0, I LPCodeVM;.stkidx
0000063c  add-int/lit8             p1, v0, -1
00000640  aget                     v2, v1, p1
00000644  aget                     v3, v1, v0
00000648  add-int/2addr            v2, v3
0000064a  aput                     v2, v1, p1
0000064e  sub-int/2addr            v0, v13
00000650  iput                     v0, p0, I LPCodeVM;.stkidx
00000654  add-int/lit8             p1, v0, -1
00000658  aget                     v2, v1, p1
0000065c  aget                     v0, v1, v0
00000660  xor-int/2addr            v0, v2
00000662  aput                     v0, v1, p1
00000666  return                   v12
00000668  iget                     p1, p0, I LPCodeVM;.stkidx
0000066c  add-int/lit8             v0, p1, 1
00000670  iput                     v0, p0, I LPCodeVM;.stkidx
00000674  iget-object              v0, p0, [I LPCodeVM;.istk
00000678  aget                     v1, v0, v8
0000067c  aput                     v1, v0, p1
00000680  return                   v12
00000682  iget                     p1, p0, I LPCodeVM;.stkidx
00000686  add-int/lit8             v0, p1, 1
0000068a  iput                     v0, p0, I LPCodeVM;.stkidx
0000068e  iget-object              v1, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000692  aget-object              v2, v1, v4
00000696  aput-object              v2, v1, p1
0000069a  nop                      
0000069c  add-int/lit8             p1, v0, 1
000006a0  iput                     p1, p0, I LPCodeVM;.stkidx
000006a4  iget-object              v2, p0, [I LPCodeVM;.istk
000006a8  aget                     v3, v2, v9
000006ac  aput                     v3, v2, v0
000006b0  sub-int/2addr            p1, v13
000006b2  iput                     p1, p0, I LPCodeVM;.stkidx
000006b6  add-int/lit8             v0, p1, -1
000006ba  add-int/lit8             v3, p1, -1
000006be  aget-object              v3, v1, v3
000006c2  add-int/lit8             v4, p1, -1
000006c6  aput-object              v11, v1, v4
000006ca  check-cast               v3, [B
000006ce  aget                     p1, v2, p1
000006d2  aget-byte                p1, v3, p1
000006d6  aput                     p1, v2, v0
000006da  return                   v12
000006dc  iget                     p1, p0, I LPCodeVM;.stkidx
000006e0  add-int/lit8             v0, p1, 1
000006e4  iput                     v0, p0, I LPCodeVM;.stkidx
000006e8  iget-object              v1, p0, [Ljava/lang/Object; LPCodeVM;.lstk
000006ec  aget-object              v2, v1, v3
000006f0  aput-object              v2, v1, p1
000006f4  nop                      
000006f6  add-int/lit8             p1, v0, 1
000006fa  iput                     p1, p0, I LPCodeVM;.stkidx
000006fe  iget-object              p1, p0, [I LPCodeVM;.istk
00000702  aget                     v1, p1, v9
00000706  aput                     v1, p1, v0
0000070a  return                   v12
0000070c  iget-object              p1, p0, [I LPCodeVM;.istk
00000710  aget                     v0, p1, v8
00000714  add-int/2addr            v0, v13
00000716  aput                     v0, p1, v8
0000071a  return                   v12
0000071c  iget                     p1, p0, I LPCodeVM;.stkidx
00000720  add-int/lit8             v0, p1, 1
00000724  iput                     v0, p0, I LPCodeVM;.stkidx
00000728  iget-object              v0, p0, [I LPCodeVM;.istk
0000072c  aput                     v12, v0, p1
00000730  return                   v12
00000732  iget                     p1, p0, I LPCodeVM;.stkidx
00000736  add-int/lit8             v0, p1, 1
0000073a  iput                     v0, p0, I LPCodeVM;.stkidx
0000073e  iget-object              v0, p0, [I LPCodeVM;.istk
00000742  const/16                 v1, 98
00000746  aput                     v1, v0, p1
0000074a  return                   v12
0000074c  iget                     p1, p0, I LPCodeVM;.stkidx
00000750  add-int/lit8             v0, p1, 1
00000754  iput                     v0, p0, I LPCodeVM;.stkidx
00000758  iget-object              v0, p0, [I LPCodeVM;.istk
0000075c  const/16                 v1, 95
00000760  aput                     v1, v0, p1
00000764  return                   v12
00000766  iget                     p1, p0, I LPCodeVM;.stkidx
0000076a  sub-int/2addr            p1, v13
0000076c  iput                     p1, p0, I LPCodeVM;.stkidx
00000770  iget-object              v0, p0, [I LPCodeVM;.istk
00000774  aget                     p1, v0, p1
00000778  if-eqz                   p1, 3
0000077c  const/4                  v13, 0
0000077e  iput                     v13, p0, I LPCodeVM;.b
00000782  return                   v12
00000784  iget                     p1, p0, I LPCodeVM;.stkidx
00000788  add-int/lit8             v0, p1, 1
0000078c  iput                     v0, p0, I LPCodeVM;.stkidx
00000790  iget-object              v0, p0, [I LPCodeVM;.istk
00000794  aput                     v10, v0, p1
00000798  return                   v12
0000079a  iget                     p1, p0, I LPCodeVM;.stkidx
0000079e  sub-int/2addr            p1, v13
000007a0  iput                     p1, p0, I LPCodeVM;.stkidx
000007a4  iget-object              v0, p0, [I LPCodeVM;.istk
000007a8  add-int/lit8             v1, p1, -1
000007ac  aget                     v2, v0, v1
000007b0  aget                     p1, v0, p1
000007b4  rem-int/2addr            v2, p1
000007b6  aput                     v2, v0, v1
000007ba  return                   v12
000007bc  iget                     p1, p0, I LPCodeVM;.peekidx
000007c0  add-int/lit8             v0, p1, 1
000007c4  iput                     v0, p0, I LPCodeVM;.peekidx
000007c8  iget-object              v0, p0, [I LPCodeVM;.istk
000007cc  aget                     p1, v0, p1
000007d0  iput                     p1, p0, I LPCodeVM;.b
000007d4  return                   v12
000007d6  iget                     p1, p0, I LPCodeVM;.stkidx
000007da  iget                     v0, p0, I LPCodeVM;.c
000007de  sub-int/2addr            p1, v0
000007e0  iput                     p1, p0, I LPCodeVM;.stkidx
000007e4  iput                     p1, p0, I LPCodeVM;.peekidx
000007e8  return                   v12
000007ea  iget                     p1, p0, I LPCodeVM;.stkidx
000007ee  add-int/lit8             v0, p1, 1
000007f2  iput                     v0, p0, I LPCodeVM;.stkidx
000007f6  iget-object              v0, p0, [I LPCodeVM;.istk
000007fa  aput                     v1, v0, p1
000007fe  return                   v12
00000800  iget                     p1, p0, I LPCodeVM;.stkidx
00000804  add-int/lit8             v0, p1, 1
00000808  iput                     v0, p0, I LPCodeVM;.stkidx
0000080c  iget-object              v1, p0, [I LPCodeVM;.istk
00000810  const/16                 v2, 43
00000814  aput                     v2, v1, p1
00000818  sub-int/2addr            v0, v13
0000081a  iput                     v0, p0, I LPCodeVM;.stkidx
0000081e  add-int/lit8             p1, v0, -1
00000822  aget                     v2, v1, p1
00000826  aget                     v3, v1, v0
0000082a  add-int/2addr            v2, v3
0000082c  aput                     v2, v1, p1
00000830  nop                      
00000832  add-int/lit8             p1, v0, 1
00000836  iput                     p1, p0, I LPCodeVM;.stkidx
0000083a  sub-int/2addr            p1, v10
0000083c  aget                     p1, v1, p1
00000840  aput                     p1, v1, v0
00000844  return                   v12
00000846  iget                     p1, p0, I LPCodeVM;.stkidx
0000084a  add-int/lit8             v0, p1, 1
0000084e  iput                     v0, p0, I LPCodeVM;.stkidx
00000852  iget-object              v0, p0, [I LPCodeVM;.istk
00000856  iget                     v1, p0, I LPCodeVM;.c
0000085a  aput                     v1, v0, p1
0000085e  return                   v12
00000860  iget                     p1, p0, I LPCodeVM;.stkidx
00000864  add-int/lit8             v0, p1, 1
00000868  iput                     v0, p0, I LPCodeVM;.stkidx
0000086c  iget-object              v0, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000870  aget-object              v1, v0, v3
00000874  aput-object              v1, v0, p1
00000878  return                   v12
0000087a  iget-object              p1, p0, [Ljava/lang/Object; LPCodeVM;.lstk
0000087e  iget                     v0, p0, I LPCodeVM;.stkidx
00000882  add-int/lit8             v1, v0, -1
00000886  aget-object              v1, p1, v1
0000088a  sub-int/2addr            v0, v13
0000088c  aput-object              v11, p1, v0
00000890  iput-object              v1, p0, Ljava/lang/Object; LPCodeVM;.i
00000894  return                   v12
00000896  iget                     p1, p0, I LPCodeVM;.stkidx
0000089a  add-int/lit8             v0, p1, 1
0000089e  iput                     v0, p0, I LPCodeVM;.stkidx
000008a2  iget-object              v1, p0, [I LPCodeVM;.istk
000008a6  aput                     v12, v1, p1
000008aa  sub-int/2addr            v0, v13
000008ac  iput                     v0, p0, I LPCodeVM;.stkidx
000008b0  aget                     p1, v1, v0
000008b4  aput                     p1, v1, v9
000008b8  return                   v12
000008ba  iget                     p1, p0, I LPCodeVM;.stkidx
000008be  sub-int/2addr            p1, v13
000008c0  iput                     p1, p0, I LPCodeVM;.stkidx
000008c4  iget-object              v0, p0, [I LPCodeVM;.istk
000008c8  aget                     p1, v0, p1
000008cc  aput                     p1, v0, v6
000008d0  return                   v12
000008d2  iget                     p1, p0, I LPCodeVM;.stkidx
000008d6  add-int/lit8             v0, p1, 1
000008da  iput                     v0, p0, I LPCodeVM;.stkidx
000008de  iget-object              v1, p0, [I LPCodeVM;.istk
000008e2  aput                     v12, v1, p1
000008e6  sub-int/2addr            v0, v13
000008e8  iput                     v0, p0, I LPCodeVM;.stkidx
000008ec  aget                     p1, v1, v0
000008f0  aput                     p1, v1, v7
000008f4  nop                      
000008f6  add-int/lit8             p1, v0, 1
000008fa  iput                     p1, p0, I LPCodeVM;.stkidx
000008fe  aput                     v12, v1, v0
00000902  return                   v12
00000904  iget                     p1, p0, I LPCodeVM;.stkidx
00000908  sub-int/2addr            p1, v13
0000090a  iput                     p1, p0, I LPCodeVM;.stkidx
0000090e  iget-object              v0, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000912  aget-object              v1, v0, p1
00000916  aput-object              v11, v0, p1
0000091a  aput-object              v1, v0, v3
0000091e  return                   v12
00000920  iget                     p1, p0, I LPCodeVM;.stkidx
00000924  add-int/lit8             v0, p1, 1
00000928  iput                     v0, p0, I LPCodeVM;.stkidx
0000092c  iget-object              v1, p0, [Ljava/lang/Object; LPCodeVM;.lstk
00000930  aget-object              v2, v1, v4
00000934  aput-object              v2, v1, p1
00000938  add-int/lit8             p1, v0, -1
0000093c  add-int/lit8             v2, v0, -1
00000940  aget-object              v2, v1, v2
00000944  add-int/lit8             v3, v0, -1
00000948  aput-object              v11, v1, v3
0000094c  iget-object              v3, p0, [I LPCodeVM;.istk
00000950  check-cast               v2, [B
00000954  array-length             v2, v2
00000956  aput                     v2, v3, p1
0000095a  add-int/lit8             p1, v0, -1
0000095e  sub-int/2addr            v0, v13
00000960  aget                     v0, v3, v0
00000964  new-array                v0, v0, [B
00000968  aput-object              v0, v1, p1
0000096c  return                   v12
0000096e  nop                      
00000970  packed-switch-payload    (size)55 (first/last key)1 [0x47b,
0x46d,0x454,0x448,0x436,0x428,0x41b,0x40e,0x3eb,0x3e0,0x3d6,0x3c9,0x3b8,
0x3ad,0x39e,0x391,0x384,0x379,0x371,0x359,0x32c,0x31f,0x2fc,0x2ef,0x2cf,
0x2c4,0x2b7,0x294,0x285,0x279,0x26f,0x24f,0x238,0x22c,0x21f,0x212,0x203,
0x1f6,0x1d2,0x1c1,0x1b6,0x1a5,0x18e,0x163,0x143,0x136,0x106,0xe3,0xbe,
0x8e,0x76,0x5a,0x3e,0x18,0x4]


Instruction counter program
Number of different instructions present in the method: 1d
new-array [23] appears: 1 times
rem-int/2addr [b4] appears: 1 times
if-eqz [38] appears: 1 times
xor-int/2addr [b7] appears: 1 times
if-nez [39] appears: 1 times
aput-byte [4f] appears: 3 times
int-to-byte [8d] appears: 4 times
and-int/2addr [b5] appears: 3 times
iput-object [5b] appears: 2 times
array-length [21] appears: 2 times
sub-int/2addr [b1] appears: 26 times
aget-object [46] appears: 18 times
nop [0] appears: f times
if-lt [34] appears: 1 times
aput-object [4d] appears: 1e times
const/16 [13] appears: a times
iget-object [54] appears: 45 times
const/4 [12] appears: b times
aget-byte [48] appears: 7 times
packed-switch [2b] appears: 1 times
packed-switch-payload [100] appears: 1 times
iget [52] appears: 38 times
return [f] appears: 38 times
add-int/lit8 [d8] appears: 60 times
aget [44] appears: 44 times
check-cast [1f] appears: c times
iput [59] appears: 56 times
add-int/2addr [b0] appears: c times
aput [4b] appears: 40 times
```

Here we have a much bigger method, but even with that only 29 instructions are used, in anycase the disassembler shows the content of the method correctly and using a familiar format for all those who are used to analyzing **smali** code. We can see the complexity of this method in a *graph* generated also with **Kunai** and its *Intermmediate Representation* (**MjolnIR**):

<img src="https://raw.githubusercontent.com/K0deless/k0deless.github.io/master/assets/img/kunai/exec_ssa.png" alt="PCodeVM exec"/>

Remember that you can download **Kunai** on its *Github* [repository](https://github.com/Fare9/KUNAI-static-analyzer/).

With this we have seen a very brief introduction to the *disassembler* from **Kunai**, each one of the instructions contains a different format that you can find in **Kunai**'s [documentation](https://fare9.github.io/KUNAI-static-analyzer/), or directly inside of the header of the [instruction](https://github.com/Fare9/KUNAI-static-analyzer/blob/main/src/include/KUNAI/DEX/DVM/dex_instructions.hpp).

I hope this set of blogposts become handy for all those who want to start using **Kunai** for their analysis, and don't forget to leave your issues in the *Github* repository!

See you in the next post.

